{"version":3,"sources":["../source/OnFocusOutOrTapOutside.js"],"names":["OnFocusOutOrTapOutside","onFocusOutRef","onTapOutsideRef","stopListeningToTouches","current","listenToTouches","onBlur","event","onFocusOut","onTapOutsideTimer","undefined","props","onTapOutside","onTapOutsideDelay","getTogglerNode","getContainerNode","children","cloneElement","Component","propTypes","func","isRequired","number","bool","node","defaultProps"],"mappings":";;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AAMA;;AAEA;;;;AACA;;;;;;;;;;;;AAPA;AACA;AACA;AACA;;;AAMA;;;;IAIqBA,sB;;;;;;;;;;;;;;oNACpBC,a,GAAgB,+B,QAChBC,e,GAAkB,+B,QAclBC,sB,GAAyB;AAAA,UAAM,MAAKD,eAAL,CAAqBE,OAArB,CAA6BD,sBAA7B,EAAN;AAAA,G,QACzBE,e,GAAkB;AAAA,UAAM,MAAKH,eAAL,CAAqBE,OAArB,CAA6BC,eAA7B,EAAN;AAAA,G,QAClBC,M,GAAS,UAACC,KAAD;AAAA,UAAW,MAAKN,aAAL,CAAmBG,OAAnB,IAA8B,MAAKH,aAAL,CAAmBG,OAAnB,CAA2BE,MAA3B,CAAkCC,KAAlC,CAAzC;AAAA,G,QAETC,U,GAAa,UAACD,KAAD,EAAW;AACvB;AACA;AACA,OAAI,MAAKE,iBAAT,EAA4B;AAC3B,oDAAa,MAAKA,iBAAlB;AACA,UAAKA,iBAAL,GAAyBC,SAAzB;AACA;AANsB,OAOfF,UAPe,GAOA,MAAKG,KAPL,CAOfH,UAPe;;AAQvBA,cAAWD,KAAX;AACA,G,QAEDK,Y,GAAe,UAACL,KAAD,EAAW;AAAA,OACjBM,iBADiB,GACK,MAAKF,KADV,CACjBE,iBADiB;;AAEzB,mDAAa,MAAKJ,iBAAlB;AACA,SAAKA,iBAAL,GAAyB,8CAAW,YAAM;AACzC;AACA;AACA,QAAI,MAAKA,iBAAT,EAA4B;AAC3B,WAAKA,iBAAL,GAAyBC,SAAzB;AAD2B,SAEnBF,UAFmB,GAEJ,MAAKG,KAFD,CAEnBH,UAFmB;;AAG3BA,gBAAWD,KAAX;AACA;AACD,IARwB,EAQtBM,iBARsB,CAAzB;AASA,G;;;;;sCAvCmB;AAAA,OACXR,eADW,GACS,KAAKM,KADd,CACXN,eADW;;AAEnB,OAAIA,eAAJ,EAAqB;AACpB,SAAKA,eAAL;AACA;AACD;;;yCAEsB;AACtB,mDAAa,KAAKI,iBAAlB;AACA;;AAED;;;;2BA8BS;AAAA,gBACqC,KAAKE,KAD1C;AAAA,OACAG,cADA,UACAA,cADA;AAAA,OACgBC,gBADhB,UACgBA,gBADhB;AAAA,OAEFC,QAFE,GAEW,KAAKL,KAFhB,CAEFK,QAFE;;;AAIRA,cAAW,gBAAMC,YAAN,CAAmBD,QAAnB,EAA6B;AACvCV,YAAQ,KAAKA;AAD0B,IAA7B,CAAX;;AAIAU,cACC;AAAA;AAAA;AACC,UAAK,KAAKf,aADX;AAEC,uBAAkBc,gBAFnB;AAGC,qBAAgBD,cAHjB;AAIC,iBAAY,KAAKN,UAJlB;AAKEQ;AALF,IADD;;AAUA,UACC;AAAA;AAAA;AACC,UAAK,KAAKd,eADX;AAEC,uBAAkBa,gBAFnB;AAGC,qBAAgBD,cAHjB;AAIC,mBAAc,KAAKF,YAJpB;AAKEI;AALF,IADD;AASA;;;;EAxEkD,gBAAME,S;;kBAArClB,sB;;;AA2ErBA,uBAAuBmB,SAAvB,GAAmC;AAClCJ,mBAAkB,oBAAUK,IAAV,CAAeC,UADC;AAElCP,iBAAgB,oBAAUM,IAFQ;AAGlCZ,aAAY,oBAAUY,IAAV,CAAeC,UAHO;AAIlCR,oBAAmB,oBAAUS,MAAV,CAAiBD,UAJF;AAKlChB,kBAAiB,oBAAUkB,IAAV,CAAeF,UALE;AAMlCL,WAAU,oBAAUQ,IAAV,CAAeH;AANS,CAAnC;;AASArB,uBAAuByB,YAAvB,GAAsC;AACrC;AACA;AACAZ,oBAAmB,EAHkB;AAIrCR,kBAAiB;AAJoB,CAAtC","file":"OnFocusOutOrTapOutside.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport createRef from 'react-create-ref'\r\n\r\n// For some weird reason, in Chrome, `setTimeout()` would lag up to a second (or more) behind.\r\n// Turns out, Chrome developers have deprecated `setTimeout()` API entirely without asking anyone.\r\n// Replacing `setTimeout()` with `requestAnimationFrame()` can work around that Chrome bug.\r\n// https://github.com/bvaughn/react-virtualized/issues/722\r\nimport { setTimeout, clearTimeout } from 'request-animation-frame-timeout'\r\n\r\nimport OnFocusOut from './OnFocusOut'\r\nimport OnTapOutside from './OnTapOutside'\r\n\r\n/**\r\n * `<OnFocusOutOrTapOutside/>` sets `onBlur` on the child element.\r\n * Calls `onFocusOut` on focus out or tap outside.\r\n */\r\nexport default class OnFocusOutOrTapOutside extends React.Component {\r\n\tonFocusOutRef = createRef()\r\n\tonTapOutsideRef = createRef()\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst { listenToTouches } = this.props\r\n\t\tif (listenToTouches) {\r\n\t\t\tthis.listenToTouches()\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tclearTimeout(this.onTapOutsideTimer)\r\n\t}\r\n\r\n\t// These're called from outside in `<Expandable/>`.\r\n\tstopListeningToTouches = () => this.onTapOutsideRef.current.stopListeningToTouches()\r\n\tlistenToTouches = () => this.onTapOutsideRef.current.listenToTouches()\r\n\tonBlur = (event) => this.onFocusOutRef.current && this.onFocusOutRef.current.onBlur(event)\r\n\r\n\tonFocusOut = (event) => {\r\n\t\t// `onFocusOut` is triggered right after `onTapOutside`.\r\n\t\t// This workaround prevents duplicate `onFocusOut` call.\r\n\t\tif (this.onTapOutsideTimer) {\r\n\t\t\tclearTimeout(this.onTapOutsideTimer)\r\n\t\t\tthis.onTapOutsideTimer = undefined\r\n\t\t}\r\n\t\tconst { onFocusOut } = this.props\r\n\t\tonFocusOut(event)\r\n\t}\r\n\r\n\tonTapOutside = (event) => {\r\n\t\tconst { onTapOutsideDelay } = this.props\r\n\t\tclearTimeout(this.onTapOutsideTimer)\r\n\t\tthis.onTapOutsideTimer = setTimeout(() => {\r\n\t\t\t// `onFocusOut` is triggered right after `onTapOutside`.\r\n\t\t\t// This workaround prevents duplicate `onFocusOut` call.\r\n\t\t\tif (this.onTapOutsideTimer) {\r\n\t\t\t\tthis.onTapOutsideTimer = undefined\r\n\t\t\t\tconst { onFocusOut } = this.props\r\n\t\t\t\tonFocusOut(event)\r\n\t\t\t}\r\n\t\t}, onTapOutsideDelay)\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { getTogglerNode, getContainerNode } = this.props\r\n\t\tlet { children } = this.props\r\n\r\n\t\tchildren = React.cloneElement(children, {\r\n\t\t\tonBlur: this.onBlur\r\n\t\t})\r\n\r\n\t\tchildren = (\r\n\t\t\t<OnFocusOut\r\n\t\t\t\tref={this.onFocusOutRef}\r\n\t\t\t\tgetContainerNode={getContainerNode}\r\n\t\t\t\tgetTogglerNode={getTogglerNode}\r\n\t\t\t\tonFocusOut={this.onFocusOut}>\r\n\t\t\t\t{children}\r\n\t\t\t</OnFocusOut>\r\n\t\t)\r\n\r\n\t\treturn (\r\n\t\t\t<OnTapOutside\r\n\t\t\t\tref={this.onTapOutsideRef}\r\n\t\t\t\tgetContainerNode={getContainerNode}\r\n\t\t\t\tgetTogglerNode={getTogglerNode}\r\n\t\t\t\tonTapOutside={this.onTapOutside}>\r\n\t\t\t\t{children}\r\n\t\t\t</OnTapOutside>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nOnFocusOutOrTapOutside.propTypes = {\r\n\tgetContainerNode: PropTypes.func.isRequired,\r\n\tgetTogglerNode: PropTypes.func,\r\n\tonFocusOut: PropTypes.func.isRequired,\r\n\tonTapOutsideDelay: PropTypes.number.isRequired,\r\n\tlistenToTouches: PropTypes.bool.isRequired,\r\n\tchildren: PropTypes.node.isRequired\r\n}\r\n\r\nOnFocusOutOrTapOutside.defaultProps = {\r\n\t// `onFocusOut` is triggered right after `onTapOutside`.\r\n\t// This workaround prevents duplicate `onFocusOut` call.\r\n\tonTapOutsideDelay: 30,\r\n\tlistenToTouches: true\r\n}"]}