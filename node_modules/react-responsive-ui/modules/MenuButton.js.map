{"version":3,"sources":["../source/MenuButton.js"],"names":["ContextAwareMenuButton","props","context","registerMenuButton","toggleMenu","menuIsExpanded","MenuButton","onClick","event","preventDefault","cooldown","setCooldown","cooldownTimer","storeButtonNode","node","button","unregister","element","children","icon","expanded","createElement","ref","link","className","component","MenuButtonIcon","rest","properties","getButtonProps","href","getChildren","type","PureComponent","propTypes","func","isRequired","bool","string","title","elementType","style","object","oneOfType"],"mappings":"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","file":"MenuButton.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport classNames from 'classnames'\r\n\r\n// For some weird reason, in Chrome, `setTimeout()` would lag up to a second (or more) behind.\r\n// Turns out, Chrome developers have deprecated `setTimeout()` API entirely without asking anyone.\r\n// Replacing `setTimeout()` with `requestAnimationFrame()` can work around that Chrome bug.\r\n// https://github.com/bvaughn/react-virtualized/issues/722\r\nimport { setTimeout, clearTimeout } from 'request-animation-frame-timeout'\r\n\r\nimport { Context } from './PageAndMenu'\r\nimport MenuIcon from './MenuIcon'\r\n\r\nconst ContextAwareMenuButton = (props) => (\r\n\t<Context.Consumer>\r\n\t\t{(context) => (\r\n\t\t\t<MenuButton\r\n\t\t\t\t{...props}\r\n\t\t\t\tregisterMenuButton={context.registerMenuButton}\r\n\t\t\t\ttoggleMenu={context.toggleMenu}\r\n\t\t\t\tmenuIsExpanded={context.menuIsExpanded}/>\r\n\t\t)}\r\n\t</Context.Consumer>\r\n)\r\n\r\nexport default ContextAwareMenuButton\r\n\r\nclass MenuButton extends React.PureComponent {\r\n\tstatic propTypes = {\r\n\t\t// Context.\r\n\t\tregisterMenuButton : PropTypes.func.isRequired,\r\n\t\ttoggleMenu : PropTypes.func.isRequired,\r\n\t\tmenuIsExpanded : PropTypes.bool, //.isRequired,\r\n\r\n\t\t// A URL of the \"Menu\" page:\r\n\t\t// if a web browser has javascript disabled (e.g. Tor),\r\n\t\t// then the menu button will redirect to this Menu page URL.\r\n\t\t// If not set then won't redirect anywhere.\r\n\t\tlink        : PropTypes.string,\r\n\r\n\t\t// HTML `title` attribute.\r\n\t\ttitle       : PropTypes.string,\r\n\r\n\t\t// Menu button component.\r\n\t\tcomponent   : PropTypes.elementType,\r\n\r\n\t\t// Menu button icon component.\r\n\t\ticon        : PropTypes.func,\r\n\r\n\t\t// CSS class.\r\n\t\tclassName   : PropTypes.string,\r\n\r\n\t\t// CSS style object.\r\n\t\tstyle       : PropTypes.object,\r\n\r\n\t\tchildren    : PropTypes.oneOfType([\r\n\t\t\tPropTypes.node,\r\n\t\t\tPropTypes.func\r\n\t\t])\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tconst { registerMenuButton } = this.props\r\n\t\tthis.unregister = registerMenuButton({\r\n\t\t\telement: () => this.button,\r\n\t\t\tsetCooldown: this.setCooldown\r\n\t\t})\r\n\t}\r\n\r\n\tcomponentWillUnmount() {\r\n\t\tthis.unregister()\r\n\t\tclearTimeout(this.cooldownTimer)\r\n\t}\r\n\r\n\tonClick = (event) => {\r\n\t\tevent.preventDefault()\r\n\t\tconst { toggleMenu } = this.props\r\n\t\t// A workaround for Safari (both macOS and iOS) bug: `<button/>`s not getting focus.\r\n\t\t// https://stackoverflow.com/questions/20359962/jquery-mobile-focusout-event-for-relatedtarget-returns-incorrect-result-in-safar\r\n\t\tif (!this.cooldown) {\r\n\t\t\ttoggleMenu()\r\n\t\t}\r\n\t}\r\n\r\n\tsetCooldown = () => {\r\n\t\t// A workaround for Safari (both macOS and iOS) bug: `<button/>`s not getting focus.\r\n\t\t// https://stackoverflow.com/questions/20359962/jquery-mobile-focusout-event-for-relatedtarget-returns-incorrect-result-in-safar\r\n\t\t// Sets a small \"cooldown\" on hide on focus out.\r\n\t\tthis.cooldown = true\r\n\t\tthis.cooldownTimer = setTimeout(() => this.cooldown = false, 30)\r\n\t}\r\n\r\n\tstoreButtonNode = (node) => this.button = node\r\n\r\n\tgetChildren() {\r\n\t\tconst {\r\n\t\t\tmenuIsExpanded,\r\n\t\t\tchildren,\r\n\t\t\ticon\r\n\t\t} = this.props;\r\n\r\n\t\tif (children) {\r\n\t\t\tif (typeof children === 'function') {\r\n\t\t\t\treturn children({ expanded: menuIsExpanded })\r\n\t\t\t}\r\n\t\t\treturn children\r\n\t\t}\r\n\r\n\t\treturn React.createElement(icon || MenuIcon, { expanded: menuIsExpanded })\r\n\t}\r\n\r\n\tgetButtonProps() {\r\n\t\tconst { menuIsExpanded } = this.props\r\n\t\treturn {\r\n\t\t\tref: this.storeButtonNode,\r\n\t\t\tonClick: this.onClick,\r\n\t\t\t// 'aria-label': 'Menu',\r\n\t\t\t// 'aria-haspopup': 'menu',\r\n\t\t\t// `menuIsExpanded` property can be `undefined` to differentiate\r\n\t\t\t// between \"has been toggled yet\"/\"has not been toggled yet\"\r\n\t\t\t// to workaround the CSS animation bug.\r\n\t\t\t'aria-expanded': menuIsExpanded ? true : false,\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tlink,\r\n\t\t\tclassName,\r\n\t\t\tcomponent,\r\n\r\n\t\t\t// Getting \"rest\" properties.\r\n\t\t\ticon: MenuButtonIcon,\r\n\t\t\tchildren,\r\n\t\t\tmenuIsExpanded,\r\n\t\t\ttoggleMenu,\r\n\t\t\tregisterMenuButton,\r\n\t\t\t...rest\r\n\t\t} = this.props\r\n\r\n\t\tconst properties = {\r\n\t\t\t...rest,\r\n\t\t\t...this.getButtonProps()\r\n\t\t}\r\n\r\n\t\tif (component) {\r\n\t\t\treturn React.createElement(component, properties)\r\n\t\t}\r\n\r\n\t\tproperties.className = classNames('rrui__button-reset', 'rrui__outline', className, {\r\n\t\t\t// Only when using an `icon` component.\r\n\t\t\t'rrui__menu-button': !component && !children\r\n\t\t})\r\n\r\n\t\t// A link.\r\n\t\tif (link) {\r\n\t\t\treturn React.createElement(\r\n\t\t\t\t'a',\r\n\t\t\t\t{\r\n\t\t\t\t\t...properties,\r\n\t\t\t\t\thref: link\r\n\t\t\t\t},\r\n\t\t\t\tthis.getChildren()\r\n\t\t\t)\r\n\t\t}\r\n\r\n\t\t// A button.\r\n\t\treturn React.createElement(\r\n\t\t\t'button',\r\n\t\t\t{\r\n\t\t\t\t...properties,\r\n\t\t\t\ttype: 'button'\r\n\t\t\t},\r\n\t\t\tthis.getChildren()\r\n\t\t)\r\n\t}\r\n}"]}