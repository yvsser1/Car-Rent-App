{"version":3,"sources":["../source/InputBasic.js"],"names":["createInput","PureComponent","Component","defaultMetadata","InputBasic","state","onChange","event","props","value","newValue","target","format","indexOf","slice","setState","onBlur","_event","stopPropagation","preventDefault","focus","input","storeInput","ref","country","metadata","onFocus","Input","inputComponent","rest","propTypes","string","isRequired","func","object","elementType","defaultProps"],"mappings":"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","file":"InputBasic.js","sourcesContent":["import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport { parseIncompletePhoneNumber, formatIncompletePhoneNumber } from 'libphonenumber-js/core'\r\nimport { polyfill as reactLifecyclesCompat } from 'react-lifecycles-compat'\r\n\r\n// `PureComponent` is only available in React >= 15.3.0.\r\nconst PureComponent = React.PureComponent || React.Component\r\n\r\nexport function createInput(defaultMetadata) {\r\n\t/**\r\n\t * `InputBasic`'s caret is not as \"smart\" as the default `inputComponent`'s\r\n\t * but still works good enough. When erasing or inserting digits in the middle\r\n\t * of a phone number the caret usually jumps to the end: this is the expected\r\n\t * behaviour and it's the workaround for the [Samsung Galaxy smart caret positioning bug](https://github.com/catamphetamine/react-phone-number-input/issues/75).\r\n\t */\r\n\tclass InputBasic extends PureComponent {\r\n\t\t// Prevents React from resetting the `<input/>` caret position.\r\n\t\t// https://github.com/reactjs/react-redux/issues/525#issuecomment-254852039\r\n\t\t// https://github.com/facebook/react/issues/955\r\n\t\tstatic getDerivedStateFromProps({ value }) {\r\n\t\t\treturn { value }\r\n\t\t}\r\n\r\n\t\tstate = {}\r\n\r\n\t\tonChange = (event) => {\r\n\t\t\tconst { onChange } = this.props\r\n\t\t\tconst { value } = this.state\r\n\r\n\t\t\tlet newValue = parseIncompletePhoneNumber(event.target.value)\r\n\r\n\t\t\t// By default, if a value is something like `\"(123)\"`\r\n\t\t\t// then Backspace would only erase the rightmost brace\r\n\t\t\t// becoming something like `\"(123\"`\r\n\t\t\t// which would give the same `\"123\"` value\r\n\t\t\t// which would then be formatted back to `\"(123)\"`\r\n\t\t\t// and so a user wouldn't be able to erase the phone number.\r\n\t\t\t// Working around this issue with this simple hack.\r\n\t\t\tif (newValue === value) {\r\n\t\t\t\tif (this.format(newValue).indexOf(event.target.value) === 0) {\r\n\t\t\t\t\t// Trim the last digit (or plus sign).\r\n\t\t\t\t\tnewValue = newValue.slice(0, -1)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Prevents React from resetting the `<input/>` caret position.\r\n\t\t\t// https://github.com/reactjs/react-redux/issues/525#issuecomment-254852039\r\n\t\t\t// https://github.com/facebook/react/issues/955\r\n\t\t\tthis.setState({ value: newValue }, () => onChange(newValue))\r\n\t\t}\r\n\r\n\t\t// This `onBlur` interceptor is a workaround for `redux-form`'s bug\r\n\t\t// so that it gets the up-to-date `value` in its `onBlur` handler.\r\n\t\t// Without this fix it just gets the actual (raw) input field textual value.\r\n\t\t// E.g. `+7 800 555 35 35` instead of `+78005553535`.\r\n\t\t//\r\n\t\t// New `value` is taken from `event` in `redux-form`'s `handleBlur()`.\r\n\t\t// https://github.com/erikras/redux-form/blob/785edf8aac3adc84aba2ab6898a4aa8c48687750/src/ConnectedField.js#L168\r\n\t\t// `redux-form` shouldn't have taken the new `value` from `event`.\r\n\t\t//\r\n\t\t// A developer is not supposed to pass this `onBlur` property manually.\r\n\t\t// Instead, `redux-form` passes `onBlur` to this component automatically\r\n\t\t// and this component patches that `onBlur` handler (a hacky way but works).\r\n\t\t//\r\n\t\tonBlur = (event) => {\r\n\t\t\tconst { onBlur } = this.props\r\n\t\t\tconst { value } = this.state\r\n\t\t\tif (onBlur) {\r\n\t\t\t\t// `event` is React's `SyntheticEvent`.\r\n\t\t\t\t// Its `.value` is read-only therefore cloning it.\r\n\t\t\t\tconst _event = {\r\n\t\t\t\t\t...event,\r\n\t\t\t\t\ttarget: {\r\n\t\t\t\t\t\t...event.target,\r\n\t\t\t\t\t\tvalue\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Workaround for `redux-form` event detection.\r\n\t\t\t\t// https://github.com/erikras/redux-form/blob/v5/src/events/isEvent.js\r\n\t\t\t\t_event.stopPropagation = event.stopPropagation\r\n\t\t\t\t_event.preventDefault  = event.preventDefault\r\n\t\t\t\treturn onBlur(_event)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tformat(value) {\r\n\t\t\tconst { country, metadata } = this.props\r\n\t\t\treturn formatIncompletePhoneNumber(value, country, metadata)\r\n\t\t}\r\n\r\n\t\tfocus = () => this.input.focus()\r\n\r\n\t\tstoreInput = (ref) => this.input = ref\r\n\r\n\t\trender() {\r\n\t\t\tconst {\r\n\t\t\t\tonChange,\r\n\t\t\t\tonFocus,\r\n\t\t\t\tcountry,\r\n\t\t\t\tmetadata,\r\n\t\t\t\tinputComponent: Input,\r\n\t\t\t\t...rest\r\n\t\t\t} = this.props\r\n\r\n\t\t\t// Prevents React from resetting the `<input/>` caret position.\r\n\t\t\t// https://github.com/reactjs/react-redux/issues/525#issuecomment-254852039\r\n\t\t\t// https://github.com/facebook/react/issues/955\r\n\t\t\tconst { value } = this.state\r\n\r\n\t\t\t// Deprecated. Should be removed in a future major version release.\r\n\t\t\t// `type=\"tel\"` and `autoComplete=\"tel\"` properties are here\r\n\t\t\t// just for the \"Without country select\" component exported from\r\n\t\t\t// `react-phone-number-input/basic-input` subpackage.\r\n\t\t\t// These two properties will be overwritten by `<PhoneInput/>` properties\r\n\t\t\t// when not used as a \"Without country select\" component.\r\n\r\n\t\t\treturn (\r\n\t\t\t\t<Input\r\n\t\t\t\t\ttype=\"tel\"\r\n\t\t\t\t\tautoComplete=\"tel\"\r\n\t\t\t\t\t{...rest}\r\n\t\t\t\t\tref={this.storeInput}\r\n\t\t\t\t\tvalue={this.format(value)}\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonFocus={onFocus}\r\n\t\t\t\t\tonBlur={this.onBlur}/>\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\r\n\tInputBasic.propTypes = {\r\n\t\t// The parsed phone number.\r\n\t\t// \"Parsed\" not in a sense of \"E.164\"\r\n\t\t// but rather in a sense of \"having only\r\n\t\t// digits and possibly a leading plus character\".\r\n\t\t// Examples: `\"\"`, `\"+\"`, `\"+123\"`, `\"123\"`.\r\n\t\tvalue : PropTypes.string.isRequired,\r\n\r\n\t\t// Updates the `value`.\r\n\t\tonChange : PropTypes.func.isRequired,\r\n\r\n\t\t// Toggles the `--focus` CSS class.\r\n\t\t// https://github.com/catamphetamine/react-phone-number-input/issues/189\r\n\t\tonFocus : PropTypes.func,\r\n\r\n\t\t// `onBlur` workaround for `redux-form`'s bug.\r\n\t\tonBlur : PropTypes.func,\r\n\r\n\t\t// A two-letter country code for formatting `value`\r\n\t\t// as a national phone number (e.g. `(800) 555 35 35`).\r\n\t\t// E.g. \"US\", \"RU\", etc.\r\n\t\t// If no `country` is passed then `value`\r\n\t\t// is formatted as an international phone number.\r\n\t\t// (e.g. `+7 800 555 35 35`)\r\n\t\tcountry : PropTypes.string,\r\n\r\n\t\t// `libphonenumber-js` metadata.\r\n\t\tmetadata : PropTypes.object.isRequired,\r\n\r\n\t\t// The `<input/>` component.\r\n\t\tinputComponent : PropTypes.elementType.isRequired\r\n\t}\r\n\r\n\tInputBasic.defaultProps = {\r\n\t\tmetadata: defaultMetadata,\r\n\t\tinputComponent: 'input'\r\n\t}\r\n\r\n\treturn reactLifecyclesCompat(InputBasic)\r\n}\r\n\r\nexport default createInput()"]}